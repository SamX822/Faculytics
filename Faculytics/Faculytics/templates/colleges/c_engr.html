<!-- c_engr.html -->
{% extends "layout.html" %}
{% set title = "College of Engineering" %}

{% block content %}
<div class="flex">
    {% include "sidebar.html" %}
    <main class="ml-[260px] p-6 mt-[60px] text-gray-300">
        <h2 class="text-3xl font-bold text-white mb-4">College of Engineering</h2>

        <!-- Back to Campus button -->
        <!-- Retrieve the campus code from the query parameter, defaulting to "ucm" if not provided #} -->
        {% set campus_code = request.args.get('campus', 'ucm') %}
        <a href="{{ url_for(campus_code) }}" class="mb-4 inline-block px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white">
            Back to Campus
        </a>

        <!-- Teacher Cards Grid -->
        <div class="grid grid-cols-2 gap-6">
            {% for teacher in teachers %}
            <div class="bg-gray-700 p-4 rounded-lg flex flex-col items-center transition hover:bg-gray-600
                {% if user.userType == 'admin' %} cursor-pointer {% endif %}"
                 {% if user.userType= ='admin' %}
                 onclick="confirmDeleteTeacher({{ teacher.id }})"
                 {% endif %}>
                <!-- Circular Profile Picture Placeholder -->
                <div class="w-20 h-20 bg-white rounded-full mb-4"></div>
                <!-- Teacher Name -->
                <p class="text-white text-lg font-bold text-center">{{ teacher.firstName }} {{ teacher.lastName }}</p>
            </div>
            {% else %}
            <p class="text-gray-400 col-span-2">No teachers found for this college.</p>
            {% endfor %}
        </div>
    </main>
</div>
{% endblock %}

{% block scripts %}
    {% if user.userType == 'admin' %}
    <script>
        function confirmDeleteTeacher(teacherId) {
            console.log("confirmDeleteTeacher called with teacherId:", teacherId);
            if (confirm("Are you sure you want to delete this teacher account? This action cannot be undone.")) {
                let deleteUrl = "{{ url_for('delete_teacher', teacher_id=0) }}".replace('0', teacherId);
                console.log("Deleting teacher at:", deleteUrl);
                fetch(deleteUrl, { method: 'POST' })
                .then(response => {
                    if(response.redirected){
                        window.location.href = response.url;
                    } else {
                        location.reload();
                    }
                })
                .catch(error => {
                    console.error("Error deleting teacher:", error);
                });
            }
        }
    </script>
    {% endif %}
{% endblock %}


