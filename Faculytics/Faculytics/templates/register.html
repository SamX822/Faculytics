{% extends "layout.html" %}
{% set title = "Register" %}
{% set year = 2025 %}

{% block content %}
<div class="register-container">
    <!-- Back Button -->
    <div class="back-btn">
        <a href="{{ url_for('login') }}" class="btn btn-default">Back to Login</a>
    </div>

    <h2 class="text-center">Register</h2>

    <!-- Position Selection Pane -->
    <div id="positionPane" class="form-panel">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title text-center">Please select your position</h3>
            </div>
            <div class="panel-body">
                <div class="form-group">
                    <label for="userType">Position</label>
                    <select id="userType" class="form-control">
                        <option value="Unselected">Unselected</option>
                        <option value="Campus Director">Campus Director</option>
                        <option value="Vice Chancellor">Vice Chancellor</option>
                        <option value="Dean">Dean</option>
                        <option value="Teacher">Teacher</option>
                    </select>
                </div>
                <button id="nextButton" class="btn btn-primary" disabled>Next</button>
            </div>
        </div>
    </div>

    <!-- Account Details Pane -->
    <div id="accountPane" class="form-panel" style="display:none;">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title text-center">Account Details</h3>
            </div>
            <div class="panel-body">
                <form id="registerForm" method="POST" action="{{ url_for('register') }}">
                    <!-- Hidden field to store the userType selected in the first pane -->
                    <input type="hidden" id="selectedUserType" name="userType" value="">

                    <div class="form-group">
                        <label for="firstName">First Name</label>
                        <input type="text" id="firstName" name="firstName" class="form-control" placeholder="Enter first name">
                    </div>
                    <div class="form-group">
                        <label for="lastName">Last Name</label>
                        <input type="text" id="lastName" name="lastName" class="form-control" placeholder="Enter last name">
                    </div>
                    <div class="form-group">
                        <label for="uName">Username</label>
                        <input type="text" id="uName" name="uName" class="form-control" placeholder="Choose a username">
                    </div>
                    <div class="form-group">
                        <label for="pWord">Password</label>
                        <input type="password" id="pWord" name="pWord" class="form-control" placeholder="Choose a password">
                    </div>
                    <div class="form-group">
                        <label for="campus">Campus</label>
                        <input type="text" id="campus" name="campus" class="form-control" placeholder="Enter campus">
                    </div>
                    <div class="form-group" id="collegeGroup" style="display:none;">
                        <label for="college">College</label>
                        <input type="text" id="college" name="college" class="form-control" placeholder="Enter college">
                    </div>
                    <button type="submit" id="registerButton" class="btn btn-success" disabled>Register</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    $(document).ready(function () {
        $('#userType').change(function () {
            $('#nextButton').prop('disabled', $(this).val() === 'Unselected');
        });

        $('#nextButton').click(function () {
            var selectedType = $('#userType').val();
            $('#selectedUserType').val(selectedType);
            if (selectedType === 'Dean' || selectedType === 'Teacher') {
                $('#collegeGroup').show();
            } else {
                $('#collegeGroup').hide();
            }
            $('#positionPane').hide();
            $('#accountPane').show();
            validateForm();
        });

        $('#registerForm input').on('input change', function () {
            validateForm();
        });

        function validateForm() {
            var isValid = $('#firstName, #lastName, #uName, #pWord, #campus').toArray().every(input => $(input).val().trim() !== '');
            if ($('#selectedUserType').val() === 'Dean' || $('#selectedUserType').val() === 'Teacher') {
                isValid = isValid && $('#college').val().trim() !== '';
            }
            $('#registerButton').prop('disabled', !isValid);
        }
    });
</script>
{% endblock %}

<style>
    /* Centering the form */
    .register-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        padding: 20px;
    }

    .back-btn {
        width: 100%;
        max-width: 400px;
        margin-bottom: 20px;
    }

    .form-panel {
        width: 100%;
        max-width: 400px;
        padding: 20px;
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .form-group {
        width: 100%;
    }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

    button {
        width: 100%;
        margin-top: 10px;
    }
</style>
