{% extends "layout.html" %}
{% set title = "Upload" %}

{% block content %}
<div class="flex">
    <!-- Sidebar -->
    {% include "sidebar.html" %}

    {% if user.userType == "Dean" %}
    <main class="ml-[14rem] p-6 text-gray-300 w-[100%]">

        <!-- Hidden upload section -->
        <div id="uploadContainer" class="mt-4">
            {% include "upload.html" %}
        </div>
    </main>

    {% elif user.userType == "Campus Director" or  user.userType == "Vice Chancellor" or user.userType == "Teacher" %}
    <main class="w-full ml-[260px] p-4 mt-1 transition-all duration-300 text-gray-300">
        <h2 class="text-3xl font-bold text-white shadow-md">Welcome to Your Dashboard</h2>

    </main>

    {% else %}
    {# Redirect Unauthorized Users to Login #}
    <script>
    window.location.href = "{{ url_for('login') }}";
    </script>

    {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script>document.addEventListener("DOMContentLoaded", function() {
        var toggleButton = document.getElementById("toggleUploadButton");
        var uploadContainer = document.getElementById("uploadContainer");
        if (toggleButton && uploadContainer) {
            toggleButton.addEventListener("click", function() {
                uploadContainer.classList.toggle("hidden");
            });
        }
    });

    document.getElementById("uploadForm").addEventListener("submit", function (event) {
        event.preventDefault(); // Prevent normal form submission

        let formData = new FormData(this);
        let selectedCourse = document.getElementById("courseSelect").value;

        formData.append("course", selectedCourse);

        fetch("/upload", {
            method: "POST",
            body: formData
        })
            .then(response => response.json())
            .then(data => console.log("Server Response:", data))
            .catch(error => console.error("Upload Error:", error));
    });</script>
{% endblock %}
